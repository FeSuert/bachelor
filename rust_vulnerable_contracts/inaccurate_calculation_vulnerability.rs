use anchor_lang::prelude::*;

declare_id!("F1234567890123456789012345678901234567890");

#[program]
mod inaccurate_calculation_vulnerability {
    use super::*;

    pub fn calculate_over_fee(ctx: Context<CalculateFee>, paid_amount: u64, actual_amount: u64) -> Result<()> {
        let over_fee = paid_amount.saturating_sub(actual_amount);

        ctx.accounts.user_account.over_fee = over_fee;

        Ok(())
    }
}

#[derive(Accounts)]
pub struct CalculateFee<'info> {
    #[account(mut)]
    pub user_account: Account<'info, UserAccount>,
}

#[account]
pub struct UserAccount {
    pub over_fee: u64,
}

//Recommendation: Use checked_add/checked_sub/checked_div/checked_mul instead.